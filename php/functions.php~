<?php
include('config.php');

print_r(getOperations(1, '2014/01/01', '2014/06/01'));


function getAccounts($idUser)
{
  $table = Doctrine_Core::getTable('Account');
  
  return $table->findByUser_id($idUser);
}







function getOperations($idAccount, $begin , $end, $type=0, $limit=0)
{
//   $table = Doctrine_Core::getTable('Operation');
// 
//   $operations = $table->findByAccount_id($idAccount);

  $query = Doctrine_Query::create()->from('Operation o')->where('o.operation_date >= :beginDate AND o.operation_date <= :endDate', 
								  array(':beginDate' => $begin, ':endDate' => $end));
								
  switch($type)
  {
    case CREDIT:
      $query->andWhere('o.is_credit');
      break;
    case DEBIT:
      $query->andWhere('NOT o.is_credit');
  }
  
  $query->orderBy('operation_date', 'DESC');
  
  if($limit > 0)
    $query->limit($limit);
    
  echo $query->getSqlQuery()."\n";
  return $query->execute()[0];  
}

function credit()
{

}

function debit()
{

}

echo getOperations(1, '2014/01/01', '2014/01/17')->operation_date;


?>